extends game_layout

block style
  link(rel='stylesheet', href='/css/demo.css')

block game_content
  .header
    h1 #{date_title}
      input.finish_day_button(type="button", value="Finish day", onclick="reportEndOfDay()")

  //- h2 Debug Options
  //- p

  //- p.lead
  .jumbotron
    .game_container
      .game(id="game")
  //- hr
  .container
    .row
      .attack_container
        p
          | &#x1F44A; ATTACK by logging your expense below:

  .input_container
    //- input.previous_day_button(type="button", value="<<<", onclick="goToPreviousDay()")
    input.main_input(type="text", id="expense_input")
    //- input.next_day_button(type="button", value=">>>", onclick="goToNextDay()")
    ul.game_expense_list.list-group.text-center(id="expense_list")
      li.list-group-item
        span.date
          | 18h29min
        | Lunch - burgers
        span.cost
          | €15.00
      li.list-group-item
        span.date
          | 18h29min
        | dönner kebap
        span.cost
          | €3.00
      li.list-group-item
        span.date
          | 18h30min
        | club mate
        span.cost
          | €2.00

block scripts
  //- script(src='/js/lib/jquery.inputmask.bundle.min.js')

  script.
    function reportEndOfDay() {
        console.log("reporting the end of the day...")
        //- $.get( "/game/summary/new", {date:Date.now(), balance: 20 });
        finishDay();
    }

    function insertExpense(str) {
      var description = str;
      var value = "€10.00";
      var date = new Date().toLocaleTimeString();;

      $("<li class='list-group-item'><span class='date'>"+date+"</span> "+description+" <span class='cost'>"+value+"</span></li>").prependTo("#expense_list");

    }

  script.
    $(document).ready(function(){
      $("#expense_input").keypress(function(e) {
          if(e.which == 13) {
                var expense_input = $("#expense_input").prop("value");
                $.get( "/game/expense", { date:Date.now(), value:expense_input });
                BB.heroController.attack();
                BB.monsterController.hitCurrent();
                insertExpense($("#expense_input").val());
                $("#expense_input").val("");
                POWERMODE.spawnParticles();

          }
      });
    });

  script.
    $(document).ready(function() {
      var json = $.get("/game/monster/month");
      BB.game.monsters_json = json;
      BB.monsterController.addAllMonsters();
    });

  script(src='/js/lib/activate-power-mode.js')
  script(src='/js/lib/phaser.min.js')
  script(src='/js/game/init.js')
  script(src='/js/game/monsters.js')
  script(src='/js/game/hero.js')
  script(src='/js/game/main.js')



  script.
    POWERMODE.colorful = true;
    document.body.addEventListener('input', POWERMODE);
    document.body.addEventListener('input', function() {
      BB.heroController.setCharacterPose();
    });



